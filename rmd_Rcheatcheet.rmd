---
title: "R Useful Functions"
author: "Dr Chris McNeil"
date: "13/04/2021"
output:
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*** 
# Collection of useful R syntax and methods

## Introduction

This document is intended to collect all the useful code snippets I have collected since I started using R and R studio.

I intend to organise the snippets into sections.

* data wrangling.
* data restructuring
* data manipulation (creating new variables)
* statistical analysis â€“ basic
* statistical analysis - advanced
* data visualisation

ultimately, I want this to be a working document with examples to run. I will load the required libraries when they are needed.

Initially I will use the mtcars example database

## R basic functions:

### Manipulating the environment

Remove  Items from environment:

```{r}
data("mtcars")
data("band_instruments")
data("band_instruments2") # Load example datasets
```

Remove items
```{r}
rm(list=ls()[! ls() %in% c("band_instruments","band_instruments2")]) # Everything except Band instruments
rm(list=setdiff(ls(), "band_instruments")) # Everything except "bandinstruments"
rm(list=ls()) # Remove everything
```
Reference:
[Stackoverflow](https://stackoverflow.com/questions/6190051/how-can-i-remove-all-objects-but-one-from-the-workspace-in-r)

***

## Data wrangling

```{r}
library(knitr) # for better looking tables when knitted to html
library(kableExtra) # for even better looking tables when knitted to html
```
Reference for table formatting
[Kable Extra](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html)

### Recode a text variable

Tidyverse libraries are needed for the following examples.
kn

```{r message=FALSE}
library(tidyverse)
data("band_members")
kable(head(band_members)) %>% kable_minimal(full_width = F)
band_members <- band_members %>% mutate(name=recode(name, "Mick"= "m"))
kable(head((band_members))) %>% kable_minimal(full_width = F)
rm(list=ls()) # Remove everything
```

### Bin variable based on The value ( e.g. Low/Medium/High)

```{r}
data(mtcars)
mtcars <- mtcars %>% mutate(hp_cat=cut(hp, breaks=c(-Inf, 100, Inf), labels=c("low hp","high hp")))
```

### Perform a function that is conditional 

```{r}
mtcars <- mtcars %>% mutate(loghp=ifelse(cyl>4,log10(hp),NA)) # Nonsensical example, but log transformed all horse powers of cars with more than four cylinders
```

### Conditional Replacements

Replace all 'NA's in a specified variable with 0.
```{r}
mtcars <- mtcars %>% mutate(loghp = coalesce(loghp, 0))
```




